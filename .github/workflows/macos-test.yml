name: Installation Test (native)
on: push

# Available runners
# https://docs.github.com/en/actions/using-github-hosted-runners/about-github-hosted-runners#supported-runners-and-hardware-resources
jobs:
  local:
    name: Local Installation (${{ matrix.os }}) [${{ matrix.flag }}]
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [macos-11]
        flag: [-v, '', -q]
    steps:
      - uses: actions/checkout@v3
      - name: Clean Up Environment
        run: |
          if test -n "$(command -v brew)"; then
            brew uninstall --force --ignore-dependencies $(brew list)
          fi
      - name: Installation Info
        run: |
          sh install.sh -i
      - name: Perform Installation
        env:
          FLAG: ${{ matrix.flag }}
        run: |
          sh install.sh $FLAG no-app-store

  remote:
    name: Remote Installation (${{ matrix.os }}) [${{ matrix.flag }}]
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [macos-11]
        flag: [-v, '', -q]
    steps:
      - uses: actions/checkout@v3
      - name: Clean Up Environment
        run: |
          if test -n "$(command -v brew)"; then
            brew uninstall --force --ignore-dependencies $(brew list)
          fi
      - name: Installation Info
        run: |
          sh -c "$(curl -sSL dots.spywhere.me)" - -i
      - name: Perform Installation
        env:
          FLAG: ${{ matrix.flag }}
        run: |
          sh -c "$(curl -sSL dots.spywhere.me)" - $FLAG no-app-store
